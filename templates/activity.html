{% extends "admin/base_site.html" %}
{% load adminmedia %} 
{% load i18n admin_modify adminmedia %}
{% block breadcrumbs %}
        <div class="breadcrumbs">
                <a href="/">{% trans 'Index' %}</a> |
                <a href="/admin">{% trans 'Admin' %}</a> |
		<a href="/ev">{% trans 'Evaluations' %}</a> |
		
        </div>
{% endblock %}

{% block branding %}
<h1 id="site-name">{% trans 'Local Earthquake [ALPHA]' %}</h1>
{% endblock %}


{% block extrahead %}

<link rel="stylesheet" type="text/css" href="/static/admin/css/forms.css"/>
<link rel="stylesheet" type="text/css" href="/static/admin/css/global.css"/>
<link rel="stylesheet" type="text/css" href="/static/admin/css/widgets.css"/>

<script type="text/javascript" src="/admin/jsi18n/"></script>
<script type="text/javascript" src="/static/admin/js/core.js"></script>
<script type="text/javascript" src="/static/admin/js/admin/RelatedObjectLookups.js"></script>
<script type="text/javascript" src="/static/admin/js/jquery.js"></script>
<script type="text/javascript" src="/static/admin/js/jquery.init.js"></script>
<script type="text/javascript" src="/static/admin/js/actions.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>

<style type="text/css">

ul li { 
list-style-type: square;
padding: 1px 0px;
}
li, dt, dd { 
font-size: 11px;
line-height: 14px;
}
li { 
display:inline-block;
width:60px;
}

.mystyle1 {
                background-color: #FFFFFF;
                color: #3366CC;
                font: 13px Verdana;
                font-weight: bold;    
                text-align: center; }
</style>
{{ form.media }}
{% endblock %}


{% block content %}

	<script type='text/javascript'>
			google.load('visualization', '1',
         		 	{'packages': ['table', 'map', 'corechart','imagechart']});
			      	google.setOnLoadCallback(initialize);

			function initialize() {
			        // The URL here is the URL of the spreadsheet.
			        // This is where the data is.
				var query = new google.visualization.Query(
			            	'https://spreadsheets.google.com/pub?key=pCQbetd-CptF0r8qmCOlZGg');
					 query.send(draw);
      			}

			function draw(response) {
			       	if (response.isError()) {
					alert('Error in query');
        			}
			}

			google.setOnLoadCallback(drawTable);
			function drawTable() {
				var data = new google.visualization.DataTable();
        	                data.addColumn('string', 'Date');
        	                data.addColumn('string', 'Time');
        	                data.addColumn('string', 'Arrived to');
        	                data.addColumn('string', 'Location');
               			data.addColumn('string', 'Magnitude');
 	                       	data.addColumn('string', 'Deep');
        	                data.addColumn('string', 'Checked');
                        	data.addRows( {{quakes|length}} );

			{% for quake in quakes %}
				data.setCell({{forloop.counter|add:"-1" }}, 0,'{{quake.event_date}}');
				data.setCell({{forloop.counter|add:"-1" }}, 1,'{{quake.p_hh}}:{{quake.p_mm}}:{{quake.p_ss}}');
				data.setCell({{forloop.counter|add:"-1" }}, 2,'{{quake.arrival_station}}');
				data.setCell({{forloop.counter|add:"-1" }}, 3,'{{quake.location}}');
				data.setCell({{forloop.counter|add:"-1" }}, 4,'{{quake.local_magnitude}}');
				data.setCell({{forloop.counter|add:"-1" }}, 5,'{{quake.deep}}');
				data.setCell({{forloop.counter|add:"-1" }}, 6,'{{quake.checked}}');
               		{%endfor%}
				
			var gData = new google.visualization.DataTable();
   		
				gData.addRows({{ quakes|length}});
				gData.addColumn('number', 'LATITUDE', 'Latitude');
        			gData.addColumn('number', 'LONGITUDE', 'Longitude');
        			gData.addColumn('number', 'VALUE', 'Value'); 
        			gData.addColumn('string', 'HOVER', 'HoverText');
	
		      		{% for quake in quakes %}
                			gData.setCell({{ forloop.counter|add:"-1" }},0,{{ quake.latitude|stringformat:"f" }});
                			gData.setCell({{ forloop.counter|add:"-1" }},1,{{ quake.longitude|stringformat:"f" }});
                			gData.setCell({{ forloop.counter|add:"-1" }},2,0);
                			gData.setCell({{ forloop.counter|add:"-1" }},3,'{{ quake.deep }}');
        			{% endfor %}
			 
	
			var geoView = new google.visualization.DataView(gData);
		        geoView.setColumns([0, 1]);
			
		        var table = new google.visualization.Table(document.getElementById('quakes_table'));
        		table.draw(data, {showRowNumber: false});

	
			var map =  new google.visualization.Map(document.getElementById('map_div'));
		        map.draw(geoView, {showTip: true});
     			
		        google.visualization.events.addListener(table, 'select',
		            	function() {
		              		map.setSelection(table.getSelection());
				});
			google.visualization.events.addListener(map, 'select',
       				function() {
              				table.setSelection(map.getSelection());
            			});
			}
	</script>


<div id="content-main">
	<body>
	<table border=3>
	<tr>
		<td> 
			<div id='quakes_table'></div>

		</td>
		<td> 
			<div id='map_div'></div>
		</td>
	</tr>
	</table>
	</body>
</div>
{% endblock %}

